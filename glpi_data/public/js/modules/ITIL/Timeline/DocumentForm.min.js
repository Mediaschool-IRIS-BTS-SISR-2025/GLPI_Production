/**
 * ---------------------------------------------------------------------
 *
 * GLPI - Gestionnaire Libre de Parc Informatique
 *
 * http://glpi-project.org
 *
 * @copyright 2015-2025 Teclib' and contributors.
 * @copyright 2003-2014 by the INDEPNET Development Team.
 * @licence   https://www.gnu.org/licenses/gpl-3.0.html
 *
 * ---------------------------------------------------------------------
 *
 * LICENSE
 *
 * This file is part of GLPI.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 * ---------------------------------------------------------------------
 */
import Screenshot from"/js/modules/Screenshot/Screenshot.js";if(Screenshot.isSupported()){$(".document_item .upload-from-section").removeClass("d-none");$(".document_item .fileupload").each((e,n)=>{Screenshot.listenOnFileUpload(n)});const e=$('.document_item button[name="add_screenshot"]');const n=$('.document_item button[name="add_screenrecording"]');const o=$('.document_item button[name="stop_recording"]');const t=$("#screen_capture_preview");e.removeClass("d-none");n.removeClass("d-none");e.on("click",()=>{o.addClass("d-none");Screenshot.captureScreenshot().then(e=>{const n=t.find(".previews").children().length;const o=`screenshot${n}.png`;Screenshot.appendPreviewImg(t.find(".previews"),e,"200px",o);e.toBlob(n=>{n.name=o;window.uploadFile(n,{getElement:()=>t.get(0)});e.remove()},"image/png")})});n.on("click",()=>{const e=[];Screenshot.startRecording().then(n=>{o.removeClass("d-none");n.ondataavailable=n=>{e.push(n.data);const o=t.find(".previews").children().length;const s=`screen_capture${o}.webm`;n.data.name=s;Screenshot.appendPreviewVideo(t.find(".previews"),n.data,"200px",s);window.uploadFile(n.data,{getElement:()=>t.get(0)})};o.on("click",()=>{n.stop();n.stream.getTracks().forEach(e=>e.stop());o.addClass("d-none")})})})}