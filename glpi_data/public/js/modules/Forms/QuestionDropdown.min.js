/**
 * ---------------------------------------------------------------------
 *
 * GLPI - Gestionnaire Libre de Parc Informatique
 *
 * http://glpi-project.org
 *
 * @copyright 2015-2025 Teclib' and contributors.
 * @copyright 2003-2014 by the INDEPNET Development Team.
 * @licence   https://www.gnu.org/licenses/gpl-3.0.html
 *
 * ---------------------------------------------------------------------
 *
 * LICENSE
 *
 * This file is part of GLPI.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 * ---------------------------------------------------------------------
 */
import{GlpiFormQuestionTypeSelectable}from"/js/modules/Forms/QuestionSelectable.js";export class GlpiFormQuestionTypeDropdown extends GlpiFormQuestionTypeSelectable{constructor(t=null,e=null,i=false){super(t,e,i);this._container.closest("[data-glpi-form-editor-question-details]").find("div[data-glpi-form-editor-specific-question-options]").find("input[data-glpi-form-editor-original-name=is_multiple_dropdown]").on("change",t=>{this.#t(t.target.checked?"checkbox":"radio");this.#e()});this._container.closest("[data-glpi-form-editor-question-type-specific]").find("[data-glpi-form-editor-preview-dropdown] select").on("change",(t,e)=>{if(e&&e.skip_update){return}if(t.target.value==0){this._container.find("input[type=checkbox], input[type=radio]").prop("checked",false);return}const i=$(t.target).select2("data");this._container.find("input[type=checkbox], input[type=radio]").each((t,e)=>{const o=i.filter(t=>t.element.value==$(e).val())[0];$(e).prop("checked",o!==undefined)})});this.#e()}#t(t){this._inputType=t;this._container.closest("[data-glpi-form-editor-question-type-specific]").find('input[type="checkbox"], input[type="radio"]').each((e,i)=>{$(i).attr("type",t)});this._container.closest("[data-glpi-form-editor-question-type-specific]").find("[data-glpi-form-editor-preview-dropdown]").children().toggleClass("d-none").find("select").prop("disabled",function(){return!$(this).prop("disabled")})}#i(t){t.find('input[type="checkbox"], input[type="radio"]').attr("type",this._inputType)}#e(){const t=this._container.closest("[data-glpi-form-editor-question-type-specific]").find("[data-glpi-form-editor-preview-dropdown] select");const e=window.hasUnsavedChanges();t.find("option[value!=0]").remove();this._container.find("input[type=text]").each((e,i)=>{const o=$(i).closest("div").find("input[type=checkbox], input[type=radio]").prop("checked");const p=$(i).closest("div").find("input[type=checkbox], input[type=radio]").val();const n=$(i).val();t.append($("<option>",{value:p,text:n,selected:o})).trigger("change",{skip_update:true})});if(!e){window.setHasUnsavedChanges(false)}}_registerOptionListeners(t){super._registerOptionListeners(t);t.find('input[type="checkbox"], input[type="radio"]').on("change",()=>{this.#e()})}_handleSortableUpdate(){super._handleSortableUpdate();this.#e()}onAddOption(t){this.#e();this.#i(t)}onEditOption(){this.#e()}onRemoveOption(){this.#e()}}